<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.59" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://xchanper.github.io/coding/git-pro.html"><meta property="og:site_name" content="chanper"><meta property="og:title" content="Pro Git 阅读笔记"><meta property="og:description" content="闲来无事，读一读 Git Pro —— Git 圣经，记录一些以前没有注意过的问题和底层实现的原理。 起步 特点 Git 和其它版本控制系统在对待数据的方式上有很大的区别，大部分 VCS 系统（如 CVS、Subversion、Perforce等）以文件变更列表的方式存储系统，也就是基于文件的差异进行版本控制。 deltasdeltas 但是 Git ..."><meta property="og:type" content="article"><meta property="og:image" content="https://xchanper.github.io/img/deltas.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-06-22T07:34:10.000Z"><meta property="article:tag" content="Git"><meta property="article:published_time" content="2023-11-09T00:00:00.000Z"><meta property="article:modified_time" content="2025-06-22T07:34:10.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Pro Git 阅读笔记","image":["https://xchanper.github.io/img/deltas.png","https://xchanper.github.io/img/snapshots.png","https://xchanper.github.io/img/areas.png","https://xchanper.github.io/img/commit-and-tree.png","https://xchanper.github.io/img/commits-and-parents.png","https://xchanper.github.io/img/branch-and-history.png","https://xchanper.github.io/img/basic-branching-4.png","https://xchanper.github.io/img/basic-branching-5.png","https://xchanper.github.io/img/basic-merging-1.png","https://xchanper.github.io/img/basic-merging-2.png","https://xchanper.github.io/img/basic-rebase-3.png","https://xchanper.github.io/img/remote-branches-5.png","https://xchanper.github.io/img/reset-ex3.png","https://xchanper.github.io/img/reset-ex4.png","https://xchanper.github.io/img/reset-ex5.png","https://xchanper.github.io/img/reset-ex6.png","https://xchanper.github.io/img/reset-soft.png","https://xchanper.github.io/img/reset-mixed.png","https://xchanper.github.io/img/reset-hard.png","https://xchanper.github.io/img/reset-checkout.png","https://xchanper.github.io/img/data-model-1.png"],"datePublished":"2023-11-09T00:00:00.000Z","dateModified":"2025-06-22T07:34:10.000Z","author":[]}</script><script type="text/javascript" src="//js.users.51.la/21843597.js"></script><script src="https://www.googletagmanager.com/gtag/js?id=G-MXLC6EJHG0"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){ dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'G-MXLC6EJHG0');
            </script><link rel="icon" href="/assets/favicon.ico"><title>Pro Git 阅读笔记 | chanper</title><meta name="description" content="闲来无事，读一读 Git Pro —— Git 圣经，记录一些以前没有注意过的问题和底层实现的原理。 起步 特点 Git 和其它版本控制系统在对待数据的方式上有很大的区别，大部分 VCS 系统（如 CVS、Subversion、Perforce等）以文件变更列表的方式存储系统，也就是基于文件的差异进行版本控制。 deltasdeltas 但是 Git ...">
    <link rel="preload" href="/assets/style-CGRCDUe8.css" as="style"><link rel="stylesheet" href="/assets/style-CGRCDUe8.css">
    <link rel="modulepreload" href="/assets/app-CHBNztBQ.js"><link rel="modulepreload" href="/assets/git-pro.html-DFiiOgKI.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-C80gTbuV.js" as="script"><link rel="prefetch" href="/assets/intro.html-CtnDevkb.js" as="script"><link rel="prefetch" href="/assets/AQS.html-GFifGa0S.js" as="script"><link rel="prefetch" href="/assets/Authorization.html-C7tB0WbT.js" as="script"><link rel="prefetch" href="/assets/Elasticsearch.html-BsulRCKM.js" as="script"><link rel="prefetch" href="/assets/Guava.html-BQwA_x3X.js" as="script"><link rel="prefetch" href="/assets/Guide-RPC.html-B7ACLCvq.js" as="script"><link rel="prefetch" href="/assets/Hive-SQL.html-DqWWgyJE.js" as="script"><link rel="prefetch" href="/assets/JUC.html-Ca6sqt9f.js" as="script"><link rel="prefetch" href="/assets/JVM-GC.html-CGHNTDeH.js" as="script"><link rel="prefetch" href="/assets/JVM-reference-type.html-MyDFFpia.js" as="script"><link rel="prefetch" href="/assets/JVM-runtime-memory.html-DJUY8fYN.js" as="script"><link rel="prefetch" href="/assets/JVM.html--kyl5EmA.js" as="script"><link rel="prefetch" href="/assets/Java_base.html-CSdKT0LU.js" as="script"><link rel="prefetch" href="/assets/LockSupport.html-Q02L0oiW.js" as="script"><link rel="prefetch" href="/assets/Logging.html-BwhD-jSB.js" as="script"><link rel="prefetch" href="/assets/MQ_Abstract.html-DhCsvyrV.js" as="script"><link rel="prefetch" href="/assets/MQ_Kafka.html-IZiBFP0H.js" as="script"><link rel="prefetch" href="/assets/MyBatis.html-hR7mrUN8.js" as="script"><link rel="prefetch" href="/assets/MySQL-Lock.html-DycH4YiQ.js" as="script"><link rel="prefetch" href="/assets/MySQL01.html-Cgxbv0QH.js" as="script"><link rel="prefetch" href="/assets/MySQL02.html-NjNuvaJX.js" as="script"><link rel="prefetch" href="/assets/NIO.html-8UMHqTs1.js" as="script"><link rel="prefetch" href="/assets/Netty01.html-5u4RnztT.js" as="script"><link rel="prefetch" href="/assets/Netty02.html-Dnm3pxoV.js" as="script"><link rel="prefetch" href="/assets/index.html-BHmmbecG.js" as="script"><link rel="prefetch" href="/assets/Redis01.html-DQcmMhQY.js" as="script"><link rel="prefetch" href="/assets/Redis02.html-Cjecwv6g.js" as="script"><link rel="prefetch" href="/assets/Redis03.html-uCMzGM7H.js" as="script"><link rel="prefetch" href="/assets/Redis04.html-DWPv-S8C.js" as="script"><link rel="prefetch" href="/assets/Shred_Algorithm.html-Y9OOalGr.js" as="script"><link rel="prefetch" href="/assets/SmallSpring.html-CyFO21vT.js" as="script"><link rel="prefetch" href="/assets/SpringTransaction.html-l0GtkdJD.js" as="script"><link rel="prefetch" href="/assets/Stream.html-DGc2w7zM.js" as="script"><link rel="prefetch" href="/assets/Synchronized.html-CUcBG7PX.js" as="script"><link rel="prefetch" href="/assets/Thread.html-DIBruGsC.js" as="script"><link rel="prefetch" href="/assets/ThreadPoolExecutor.html-dTHirGa6.js" as="script"><link rel="prefetch" href="/assets/Thrift.html-D3xS1kG5.js" as="script"><link rel="prefetch" href="/assets/Unsafe.html-BwJdlrBk.js" as="script"><link rel="prefetch" href="/assets/Windows-WSL-MySQL.html-BkeCnTeG.js" as="script"><link rel="prefetch" href="/assets/Zookeeper.html-JacviOHV.js" as="script"><link rel="prefetch" href="/assets/bigdata-hadoop.html-C_RQjeRz.js" as="script"><link rel="prefetch" href="/assets/cache-migration.html-DhUvrO5e.js" as="script"><link rel="prefetch" href="/assets/code-review.html-B3fLblQ2.js" as="script"><link rel="prefetch" href="/assets/distributed-cache.html-BEpfNctq.js" as="script"><link rel="prefetch" href="/assets/distributed-transaction.html-_JGLDyKC.js" as="script"><link rel="prefetch" href="/assets/gateway.html-CAN2G3Gq.js" as="script"><link rel="prefetch" href="/assets/interview-java.html-Bjt-Tqla.js" as="script"><link rel="prefetch" href="/assets/leetcode-bitcalc.html-CS905sYt.js" as="script"><link rel="prefetch" href="/assets/leetcode-permutation.html-Gh0UxFN9.js" as="script"><link rel="prefetch" href="/assets/linux-cmd.html-DFvceA6-.js" as="script"><link rel="prefetch" href="/assets/mock-test.html-M-8WSZPp.js" as="script"><link rel="prefetch" href="/assets/AirBiz.html-CDr8v78v.js" as="script"><link rel="prefetch" href="/assets/index.html-Bp2Dz8ZP.js" as="script"><link rel="prefetch" href="/assets/arabs-history.html-D_MCAhiz.js" as="script"><link rel="prefetch" href="/assets/beijing-intern.html-Ck6vHW18.js" as="script"><link rel="prefetch" href="/assets/blog-actions.html-HuPRc53A.js" as="script"><link rel="prefetch" href="/assets/cycling.html-C60UMp1_.js" as="script"><link rel="prefetch" href="/assets/first-camera.html-BGr0jdpZ.js" as="script"><link rel="prefetch" href="/assets/movie-guide.html-D2UsXN6j.js" as="script"><link rel="prefetch" href="/assets/summary_2023.html-4dkFvqrb.js" as="script"><link rel="prefetch" href="/assets/summary_2024.html-Day_HgY3.js" as="script"><link rel="prefetch" href="/assets/travel-tibet.html-BeLEEgGJ.js" as="script"><link rel="prefetch" href="/assets/webrtc-study.html-CKzDJFU9.js" as="script"><link rel="prefetch" href="/assets/windows-dash.html-CSQ7Hsbe.js" as="script"><link rel="prefetch" href="/assets/youtube-dl-ffmpeg.html-CqZVlLYx.js" as="script"><link rel="prefetch" href="/assets/404.html-DF0F6Eot.js" as="script"><link rel="prefetch" href="/assets/index.html-B-d_w5d1.js" as="script"><link rel="prefetch" href="/assets/index.html-BDo2cFIE.js" as="script"><link rel="prefetch" href="/assets/index.html-AKkq_oht.js" as="script"><link rel="prefetch" href="/assets/index.html-vivLFBnF.js" as="script"><link rel="prefetch" href="/assets/index.html-CcZa8umk.js" as="script"><link rel="prefetch" href="/assets/index.html-DaURobZi.js" as="script"><link rel="prefetch" href="/assets/index.html-BDc6AGGy.js" as="script"><link rel="prefetch" href="/assets/index.html-C8suiVm7.js" as="script"><link rel="prefetch" href="/assets/index.html-BQV0J9RK.js" as="script"><link rel="prefetch" href="/assets/index.html-CPDQFVZB.js" as="script"><link rel="prefetch" href="/assets/index.html-zX9FIeTe.js" as="script"><link rel="prefetch" href="/assets/index.html-Dl8hSVVY.js" as="script"><link rel="prefetch" href="/assets/index.html-CyVbMr7S.js" as="script"><link rel="prefetch" href="/assets/index.html-oGqjRIyw.js" as="script"><link rel="prefetch" href="/assets/index.html-WI16dtLz.js" as="script"><link rel="prefetch" href="/assets/index.html-BzYxC6c7.js" as="script"><link rel="prefetch" href="/assets/index.html-D2yPWCCN.js" as="script"><link rel="prefetch" href="/assets/index.html-BC2g6pxj.js" as="script"><link rel="prefetch" href="/assets/index.html-DK_PkwC1.js" as="script"><link rel="prefetch" href="/assets/index.html-Bh444kai.js" as="script"><link rel="prefetch" href="/assets/index.html-DVQMPtpG.js" as="script"><link rel="prefetch" href="/assets/index.html-ZXc4VrYs.js" as="script"><link rel="prefetch" href="/assets/index.html-DZJMrI2s.js" as="script"><link rel="prefetch" href="/assets/index.html-CRtHj9iO.js" as="script"><link rel="prefetch" href="/assets/index.html-PsIJ3dA4.js" as="script"><link rel="prefetch" href="/assets/index.html-B3YqC7Mn.js" as="script"><link rel="prefetch" href="/assets/index.html-CLTOukKL.js" as="script"><link rel="prefetch" href="/assets/index.html-Dywvu_HC.js" as="script"><link rel="prefetch" href="/assets/index.html-DxQy-NRp.js" as="script"><link rel="prefetch" href="/assets/index.html-BlzPDJPQ.js" as="script"><link rel="prefetch" href="/assets/index.html-B03wZ6ZC.js" as="script"><link rel="prefetch" href="/assets/index.html-BsTUA1fn.js" as="script"><link rel="prefetch" href="/assets/index.html-CfGL3zJ9.js" as="script"><link rel="prefetch" href="/assets/index.html-B2Vz9Xss.js" as="script"><link rel="prefetch" href="/assets/index.html-B7IszEYX.js" as="script"><link rel="prefetch" href="/assets/index.html-DOrMoJzh.js" as="script"><link rel="prefetch" href="/assets/index.html-BVDJGg9_.js" as="script"><link rel="prefetch" href="/assets/index.html-BjHeiQfM.js" as="script"><link rel="prefetch" href="/assets/index.html-BWmweQ4t.js" as="script"><link rel="prefetch" href="/assets/index.html-Bi0St468.js" as="script"><link rel="prefetch" href="/assets/index.html-Dws5fSNh.js" as="script"><link rel="prefetch" href="/assets/index.html-XJa2Zi4V.js" as="script"><link rel="prefetch" href="/assets/index.html-CJ8lBl89.js" as="script"><link rel="prefetch" href="/assets/index.html-Dj9Pc_yu.js" as="script"><link rel="prefetch" href="/assets/index.html-DJjBzR0W.js" as="script"><link rel="prefetch" href="/assets/index.html-BgBncU8f.js" as="script"><link rel="prefetch" href="/assets/index.html-D1dNmDkf.js" as="script"><link rel="prefetch" href="/assets/index.html-BYNFZDU1.js" as="script"><link rel="prefetch" href="/assets/index.html-DJqR5LWd.js" as="script"><link rel="prefetch" href="/assets/index.html-BLSTo8YU.js" as="script"><link rel="prefetch" href="/assets/index.html-B8NLqo5c.js" as="script"><link rel="prefetch" href="/assets/index.html-0hoRa111.js" as="script"><link rel="prefetch" href="/assets/index.html-RhOKCeDv.js" as="script"><link rel="prefetch" href="/assets/index.html-Cxp-0I67.js" as="script"><link rel="prefetch" href="/assets/giscus-1zs_z9NH.js" as="script"><link rel="prefetch" href="/assets/flowchart-CmM7Z9UD.js" as="script"><link rel="prefetch" href="/assets/mermaid.esm.min-DRjGR9jh.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-D2Nf-uDI.js" as="script"><link rel="prefetch" href="/assets/SearchResult-CMib_yoW.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/" aria-label="带我回家"><img class="vp-nav-logo" src="/assets/avatar.jpg" alt><!----><span class="vp-site-name hide-in-pad">chanper</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="HOME"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="solar:home-smile-angle-bold" width="1em" height="1em"></iconify-icon><!--]-->HOME<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/coding/" aria-label="Coding"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="streamline:code-monitor-1" width="1em" height="1em"></iconify-icon><!--]-->Coding<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/life/" aria-label="Life"><!--[--><iconify-icon class="font-icon icon" style="" mode="style" inline icon="icomoon-free:finder" width="1em" height="1em"></iconify-icon><!--]-->Life<!----></a></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><!----><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button type="button" class="search-pro-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon" name="search"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/coding/AQS.html" aria-label="AQS 源码解析"><!---->AQS 源码解析<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/code-review.html" aria-label="Code Review"><!---->Code Review<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Elasticsearch.html" aria-label="Elasticsearch 学习"><!---->Elasticsearch 学习<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Guava.html" aria-label="Guava 笔记"><!---->Guava 笔记<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Guide-RPC.html" aria-label="Guide-RPC 代码阅读"><!---->Guide-RPC 代码阅读<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Hive-SQL.html" aria-label="Hive SQL 语法大全"><!---->Hive SQL 语法大全<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/NIO.html" aria-label="Java NIO"><!---->Java NIO<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Java_base.html" aria-label="Java 基础"><!---->Java 基础<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/JUC.html" aria-label="Java 并发学习"><!---->Java 并发学习<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/JVM-reference-type.html" aria-label="Java 引用类型"><!---->Java 引用类型<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Logging.html" aria-label="Java 日志框架"><!---->Java 日志框架<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/JVM.html" aria-label="Java 虚拟机笔记"><!---->Java 虚拟机笔记<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/JVM-GC.html" aria-label="JVM 垃圾回收"><!---->JVM 垃圾回收<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/JVM-runtime-memory.html" aria-label="JVM 运行时数据区"><!---->JVM 运行时数据区<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/leetcode-bitcalc.html" aria-label="LeetCode-位运算"><!---->LeetCode-位运算<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/leetcode-permutation.html" aria-label="LeetCode-排列组合"><!---->LeetCode-排列组合<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/linux-cmd.html" aria-label="Linux 命令备忘录"><!---->Linux 命令备忘录<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/LockSupport.html" aria-label="LockSupport 源码阅读"><!---->LockSupport 源码阅读<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/mock-test.html" aria-label="Mock 测试"><!---->Mock 测试<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/MQ_Kafka.html" aria-label="MQ-Kafka"><!---->MQ-Kafka<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/MyBatis.html" aria-label="MyBatis 深入学习"><!---->MyBatis 深入学习<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/MySQL01.html" aria-label="MySQL 基础"><!---->MySQL 基础<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/MySQL02.html" aria-label="MySQL 深入原理"><!---->MySQL 深入原理<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/MySQL-Lock.html" aria-label="MySQL 锁机制"><!---->MySQL 锁机制<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Netty01.html" aria-label="Netty 网络框架 01"><!---->Netty 网络框架 01<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Netty02.html" aria-label="Netty 网络框架 02"><!---->Netty 网络框架 02<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/coding/git-pro.html" aria-label="Pro Git 阅读笔记"><!---->Pro Git 阅读笔记<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Redis02.html" aria-label="Redis 单机"><!---->Redis 单机<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Redis03.html" aria-label="Redis 多机"><!---->Redis 多机<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Redis01.html" aria-label="Redis 数据结构"><!---->Redis 数据结构<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Redis04.html" aria-label="Redis 独立功能"><!---->Redis 独立功能<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/cache-migration.html" aria-label="Redis 缓存迁移实践"><!---->Redis 缓存迁移实践<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Thrift.html" aria-label="RPC-Thrift"><!---->RPC-Thrift<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/SpringTransaction.html" aria-label="Spring 事务"><!---->Spring 事务<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Stream.html" aria-label="Stream 流"><!---->Stream 流<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Synchronized.html" aria-label="Synchronized 锁机制"><!---->Synchronized 锁机制<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Thread.html" aria-label="Thread 源码阅读"><!---->Thread 源码阅读<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/ThreadPoolExecutor.html" aria-label="ThreadPoolExecutor 源码分析"><!---->ThreadPoolExecutor 源码分析<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Unsafe.html" aria-label="Unsafe 源码阅读"><!---->Unsafe 源码阅读<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Windows-WSL-MySQL.html" aria-label="Windows-WSL 实现MySQL主从同步"><!---->Windows-WSL 实现MySQL主从同步<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Zookeeper.html" aria-label="Zookeeper 学习笔记"><!---->Zookeeper 学习笔记<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/gateway.html" aria-label="关于网关"><!---->关于网关<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/distributed-transaction.html" aria-label="分布式事务"><!---->分布式事务<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/distributed-cache.html" aria-label="分布式缓存"><!---->分布式缓存<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/bigdata-hadoop.html" aria-label="大数据 - Hadoop 概述"><!---->大数据 - Hadoop 概述<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Shred_Algorithm.html" aria-label="手撕算法"><!---->手撕算法<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/SmallSpring.html" aria-label="手撸 Spring 项目"><!---->手撸 Spring 项目<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/MQ_Abstract.html" aria-label="消息队列概述"><!---->消息队列概述<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/Authorization.html" aria-label="认证登录"><!---->认证登录<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/coding/interview-java.html" aria-label="面试八股"><!---->面试八股<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Pro Git 阅读笔记</h1><div class="page-info"><!----><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2023年11月9日</span><meta property="datePublished" content="2023-11-09T00:00:00.000Z"></span><!----><!----><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color1 clickable" role="navigation">工具</span><!--]--><meta property="articleSection" content="工具"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color2 clickable" role="navigation">Git</span><!--]--><meta property="keywords" content="Git"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#起步">起步</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#特点">特点</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#三种状态">三种状态</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#配置文件">配置文件</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#基础">基础</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#本地命令">本地命令</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#远程仓库">远程仓库</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#标签">标签</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#gitignore-规则">.gitignore 规则</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#分支">分支</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#分支结构">分支结构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#分支管理">分支管理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#分支合并">分支合并</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#变基">变基</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#远程分支">远程分支</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#高级工具">高级工具</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#提交引用">提交引用</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#贮藏清理">贮藏清理</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#重写历史">重写历史</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#hooks">Hooks</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#数据恢复">数据恢复</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#其它">其它</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#内部原理">内部原理</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#目录结构">目录结构</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#git-对象">Git 对象</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#git-引用">Git 引用</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content" vp-content><p>闲来无事，读一读 Git Pro —— Git 圣经，记录一些以前没有注意过的问题和底层实现的原理。</p><h2 id="起步" tabindex="-1"><a class="header-anchor" href="#起步"><span>起步</span></a></h2><h3 id="特点" tabindex="-1"><a class="header-anchor" href="#特点"><span>特点</span></a></h3><p>Git 和其它版本控制系统在对待数据的方式上有很大的区别，大部分 VCS 系统（如 CVS、Subversion、Perforce等）以文件变更列表的方式存储系统，也就是基于文件的差异进行版本控制。</p><figure><img src="/img/deltas.png" alt="deltas" tabindex="0" loading="lazy"><figcaption>deltas</figcaption></figure><p>但是 Git 把数据看作是对小型文件系统的一系列快照，每次提交就会对当前的全部文件创建一个快照并保存这个快照的索引，如果文件没有修改就创建一个指向先前存储的链接。</p><figure><img src="/img/snapshots.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Git 中所有的数据在存储前都计算 SHA-1 校验和，然后以校验和来引用保存的信息。Git 数据库中保存的信息都是以文件内容的哈希值作为索引，而不是文件名。</p><h3 id="三种状态" tabindex="-1"><a class="header-anchor" href="#三种状态"><span>三种状态</span></a></h3><p>Git 管理的文件，即已跟踪的文件有三种状态，要牢记：</p><ul><li><strong>commited 已提交</strong>：数据已经安全地保存在本地数据库中</li><li><strong>modified 已修改</strong>：修改了文件，但还没保存到数据库中</li><li><strong>staged 已暂存</strong>：对一个已修改文件的当前版本做了标记，使之包含在下次提交的快照中</li></ul><p>这会让我们的 Git 项目拥有三个阶段：</p><ul><li><strong>工作区</strong>：对项目的某个版本，从 Git 压缩数据库中独立提取出来的内容，可以使用和修改，对应<code>已修改</code>状态</li><li><strong>暂存区</strong>：是一个文件，保存了下次将要提交的文件列表信息，对应<code>已暂存</code>状态</li><li><strong>Git 目录</strong>：保存项目的元数据和对象数据库的地方，对应<code>已提交</code>状态</li></ul><figure><img src="/img/areas.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>基于上面的三种状态和三个阶段，Git 的基本工作流程是这样的：</p><ol><li>在工作区修改文件</li><li>将下次想要提交的修改选择性添加到暂存区</li><li>提交更新，即找到暂存区的文件，将快照永久性存储到 Git 目录</li></ol><h3 id="配置文件" tabindex="-1"><a class="header-anchor" href="#配置文件"><span>配置文件</span></a></h3><p>Git 的配置分为三级，每一级会覆盖上一级的配置：</p><ol><li>系统级：<code>/etc/gitconfig</code>，针对系统中每一个用户以及他们仓库的通用配置，通过<code>--system</code>选项读写（Windows 在对应安装目录下）</li><li>用户级：<code>~/.gitconfig 或 ~/.config/git/config</code>，针对当前用户，通过<code>--global</code>选项读写（Windows 在C盘Users目录下）</li><li>仓库级：<code>.git/config</code>，针对特定仓库，通过<code>--local</code>选项读写</li></ol><p>可以使用<code>git config --list --show-origin --show-scope</code>命令查看当前环境所有的配置、所在文件位置，以及对应的作用域。<code>git config --show-origin user.email</code>查看最终生效的某个配置和来源。</p><h2 id="基础" tabindex="-1"><a class="header-anchor" href="#基础"><span>基础</span></a></h2><h3 id="本地命令" tabindex="-1"><a class="header-anchor" href="#本地命令"><span>本地命令</span></a></h3><h4 id="clone" tabindex="-1"><a class="header-anchor" href="#clone"><span>clone</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># HTTP/HTTPS 协议，可以指定文件夹名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/libgit2/libgit2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mylibgit</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Git 协议</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git://github.com/username/repository.git</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># SSH 协议</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git@github.com:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">usernam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">rep</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">o&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.git</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 本地协议</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /mnt/d/ProgramData/GitDemo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GitDemo2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="add" tabindex="-1"><a class="header-anchor" href="#add"><span>add</span></a></h4><p>add 命令有多个功能，比如跟踪新文件、放入暂存区、合并冲突时标记已解决等，通常可以把它理解为：精确地将内容添加到下一次提交中。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="status" tabindex="-1"><a class="header-anchor" href="#status"><span>status</span></a></h4><p><code>-s</code>参数可以简览状态，输出在文件名前有两列，第一列是暂存区状态，第二列是工作区状态，&quot;??&quot;表示尚未跟踪。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">//</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 输出：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> README</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">MM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Rakefile</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">A</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  lib/git.rb</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">?? LICENSE.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="diff" tabindex="-1"><a class="header-anchor" href="#diff"><span>diff</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 比较当前工作区和暂存区文件差异</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> diff</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 比较暂存区和数据库里最新版本的差异</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> diff</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --staged</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> diff</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --cached</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="commit" tabindex="-1"><a class="header-anchor" href="#commit"><span>commit</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 提交所有已跟踪文件的修改，包括工作区和暂存区</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -a</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="rm" tabindex="-1"><a class="header-anchor" href="#rm"><span>rm</span></a></h4><p>rm 命令操作的是暂存区和工作目录，不会影响已提交的 Git 数据库</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 取消跟踪某个文件，即删除暂存区和工作目录下的该文件（需要当前暂存区和工作目录一致）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xxx.txt</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 强制取消跟踪（强制删除，暂存区和工作目录可以不一致）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xxx.txt</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 从暂存区中删除指定文件，常用于取消跟踪已经 add 的文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --cached</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xxx.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="restore" tabindex="-1"><a class="header-anchor" href="#restore"><span>restore</span></a></h4><p>注意 rm 和 restore 语义上的区别，虽然在某些场景下效果可能一样</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 取消已暂存但尚未提交的文件修改，还原到最近依次提交时的状态</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restore</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --staged</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xxx.txt</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 还原工作目录某文件到最近一次提交的状态</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restore</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xxx.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="mv" tabindex="-1"><a class="header-anchor" href="#mv"><span>mv</span></a></h4><p>Git 并不显式跟踪文件移动，但可以通过 mv 命令推断更名操作。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a.txt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> b.txt</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 等价于下面三个命令的组合</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a.txt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> b.txt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a.txt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="log" tabindex="-1"><a class="header-anchor" href="#log"><span>log</span></a></h4><p>log 命令打印提交历史记录，支持很多种格式化工具，调整输出样式，并且支持多种过滤器限定事件、作者、关键字等等，详细参数参考 <a href="https://git-scm.com/book/zh/v2/Git-%E5%9F%BA%E7%A1%80-%E6%9F%A5%E7%9C%8B%E6%8F%90%E4%BA%A4%E5%8E%86%E5%8F%B2#pretty_format" target="_blank" rel="noopener noreferrer">Git - 查看提交历史</a>。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 打印提交日志和差异信息，并限制条目数为 2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --patch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 打印统计信息，设置展示信息详略</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --stat</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --pretty=[oneline</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">full</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">fuller]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 格式化输出，并图形化分支合并</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --pretty=format:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;%h - %an, %ar : %s&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --graph</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看 Junio Hamano 在 2008 年 10 月其间， 除了合并提交之外的哪些提交修改了测试文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --pretty=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;%h - %s&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --author=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Junio C Hamano&#39;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  			--since=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;2008-10-01&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --before=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;2008-11-01&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --no-merges</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> t/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="amend" tabindex="-1"><a class="header-anchor" href="#amend"><span>amend</span></a></h4><p>修正上次提交（提交暂存区中的文件，并修改 commit 信息），不会影响其它信息。实际上是用一个新的提交替换旧的提交，旧的提交就像从未存在过一样。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> commit</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --amend</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="reset" tabindex="-1"><a class="header-anchor" href="#reset"><span>reset</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 取消暂存 b.txt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> b.txt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 【危险】将当前分支的 HEAD 移动到指定提交上，并重置工作区和暂存区到该提交状态 </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reset</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --hard</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">commi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="远程仓库" tabindex="-1"><a class="header-anchor" href="#远程仓库"><span>远程仓库</span></a></h3><h4 id="remote" tabindex="-1"><a class="header-anchor" href="#remote"><span>remote</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 展示所有远程分支简称和URL。clone 时的源地址默认名称为 origin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 新增一个远程仓库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">shortnam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ur</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">l&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 重命名远程仓库，会同步修改跟踪的分支名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rename</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">shortnam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">new_nam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 移除某个远程仓库，会同步删除跟踪分支和配置信息</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remove</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">remot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看远程仓库信息</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">remot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># * remote origin</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#   Fetch URL: https://github.com/&lt;username&gt;/guide-rpc-framework.git</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#   Push  URL: https://github.com/&lt;username&gt;/guide-rpc-framework.git</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#   HEAD branch: master	[当前所处分支]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#   Remote branch:				               [远程仓库所有分支的状态，如已跟踪、未跟踪、已移除等]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#     master tracked</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#   Local branch configured for &#39;git pull&#39;:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#     master rebases onto remote master           [pull 时将远程 master 合到本地的 master]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#   Local ref configured for &#39;git push&#39;:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#     master pushes to master (fast-forwardable)  [push 时将本地 master 推到远程的 master]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 修改远程url</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set-url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">remote_nam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">new_ur</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">l&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="fetch" tabindex="-1"><a class="header-anchor" href="#fetch"><span>fetch</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 拉取最新的远程仓库数据到本地，但不会自动合并或修改</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fetch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">remot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="push" tabindex="-1"><a class="header-anchor" href="#push"><span>push</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将本地的 master 推送到 origin，有冲突时需要先拉取合并</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> master</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 推送本地所有分支到 origin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -all</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="标签" tabindex="-1"><a class="header-anchor" href="#标签"><span>标签</span></a></h3><p>Git 里可以给特定的提交打上一个标签，可以通过 checkout 检出。标签分两种类型：</p><ul><li><strong>轻量标签 lightweight</strong>：没有多余信息</li><li><strong>附注标签 annotated</strong>：包含标签信息等冗余信息，可以用 GPG 签名并验证</li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 检索标签</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tag</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tag</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -l</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">patter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">n&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tag</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --list</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">patter</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">n&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建轻量标签</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tag</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v1.0_lw</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建附注标签</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tag</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v1.0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;my version 1.4&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 指定提交打标签</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tag</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">tagnam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">9fceb02</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看标签信息</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">tagnam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 推送单个标签到远程仓库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">remot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">tagnam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 推送所有标签到远程仓库，包括轻量、附注</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">remot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt; </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">--tags</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除本地标签</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tag</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">tagnam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除远程仓库标签</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> :refs/tags/v1.4</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">			 # 将冒号前面的空值推送到远程标签名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --delete</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">tagnam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="gitignore-规则" tabindex="-1"><a class="header-anchor" href="#gitignore-规则"><span>.gitignore 规则</span></a></h3><ul><li>所有空行或者以<code>#</code>开头的行都会被 Git 忽略</li><li>可以使用标准的 glob 模式（简化正则）匹配，它会递归地应用在整个工作区中 <ul><li><code>*</code>匹配零个或多个任意字符</li><li><code>[abc]</code>匹配方括号中的单个字符</li><li><code>?</code>匹配一个任意字符</li><li><code>[0-9]</code>匹配范围区间</li><li><code>a/**/z</code>匹配任意中间目录，如<code>a/z, a/b/z, a/b/c/z</code></li></ul></li><li>匹配模式可以以<code>/</code>开头防止递归</li><li>匹配模式可以以<code>/</code>结尾指定目录</li><li>要忽略指定模式以外的文件或目录，可以在模式前加上叹号<code>!</code>取反</li><li>根目录下的<code>.gitignore</code>递归作用到整个仓库，子目录下的<code>.gitignore</code>仅作用于所在目录</li></ul><p><a href="https://github.com/github/gitignore" target="_blank" rel="noopener noreferrer">https://github.com/github/gitignore</a> 给出了针对各种项目和语言的忽略跟踪文件，或者直接问 ChatGPT 吧更方便。</p><h2 id="分支" tabindex="-1"><a class="header-anchor" href="#分支"><span>分支</span></a></h2><p>几乎所有的版本控制系统都以某种形式支持分支，使用分支意味着可以把正在进行的工作从开发主线上分离开来，以免影响开发主线。下面看看 Git 实现分支的逻辑，需要牢记 Git 保存的不是文件的变化或者差异，而是不同时刻的快照。</p><h3 id="分支结构" tabindex="-1"><a class="header-anchor" href="#分支结构"><span>分支结构</span></a></h3><p>假设我们现在的 Git 项目里有三个文件已经暂存，当初次执行提交时，Git 会先计算每一个子目录的校验和， 然后在 Git 仓库中将这些校验和（黄色）保存为一个树对象（蓝色），记录着目录结构和 blob 文件索引，这个树就可以看作是仓库的一个快照。随后 Git 会创建一个提交对象（白色），除了包含提交本身相关的信息，比如作者、日期等等之外，还包含一个指向这个树对象的指针。</p><figure><img src="/img/commit-and-tree.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>当我们对仓库里的文件做一些修改，再次提交时，就会再次创建若干 blob 和一个树对象，以及一个提交对象，并且这个提交对象里包含一个指向上次提交对象（父对象）的指针，这样若干次的提交就形成了一个链表结构。</p><figure><img src="/img/commits-and-parents.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>至于分支，实质上就是指向一个提交记录的可变指针，比如默认的 master 就指向了主干上最新的提交记录，而创建一个新分支/标签实际上就是创建一个指向 HEAD 所在提交记录的指针，实现上也就是往一个文件里写入 40 个字节的 SHA-1 值和 1 个换行符，因此效率非常高。HEAD 是一个特殊指针，指向当前所在的本地分支，随着 checkout 检出而移动。</p><figure><img src="/img/branch-and-history.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="分支管理" tabindex="-1"><a class="header-anchor" href="#分支管理"><span>分支管理</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> testing</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建并切换到该分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> checkout</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> issu47</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 分支重命名，缺省是当前分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">oldBranc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">h&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">newBranch</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 显示所有分支，以及他们的最新提交记录/过滤已提交/未提交</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --merged</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --no-merged</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 展示分支和对应的跟踪分支，以及提交差异</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -vv</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 列出所有分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -a</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># * 是当前所在分支，remotes 表示远程分支，origin 是某个远程仓库引用，最后是远程分支名</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">* master</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  remotes/origin/HEAD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">origin/master</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  remotes/origin/branch1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  remotes/origin/master</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hotfix</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 强制删除还未合并的分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -D</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unmerged</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>另外，团队可以根据不同的需求和常见，选择合适的分支开发流，如集中式、集成管理者、主管与副主管等等，可以参考：<a href="https://www.cnblogs.com/xueweihan/p/13524162.html" target="_blank" rel="noopener noreferrer">5 个 Git 工作流，改善你的开发流程 - 削微寒 - 博客园</a>。</p><h3 id="分支合并" tabindex="-1"><a class="header-anchor" href="#分支合并"><span>分支合并</span></a></h3><h4 id="fast-forward" tabindex="-1"><a class="header-anchor" href="#fast-forward"><span>Fast-forward</span></a></h4><p>如果一个分支的任务完成，需要将它合并入主分支。对于下面这个分支结构，当前处在 master 分支。</p><figure><img src="/img/basic-branching-4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>如果执行<code>git merge hotfix</code>，由于 hotfix 指向的 C4 提交是 merge 指向的 C2 提交的直接后继，因此 Git 将执行<code>fast-forward</code>以<strong>快进</strong>方式合并，即让 master 指针直接后移。之后可以执行 <code>git branch -d hotfix</code>删除已合并的分支。</p><figure><img src="/img/basic-branching-5.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="recursive" tabindex="-1"><a class="header-anchor" href="#recursive"><span>Recursive</span></a></h4><p>但实际中更多的是下面这种无法快进的分支合并结构，即两个分支有共同祖先，但不是直接后继。</p><figure><img src="/img/basic-merging-1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>此时如果执行<code>git merge iss53</code>，那么 Git 将针对<strong>两个分支的末端提交和它们的公共祖先</strong>执行<strong>三方合并</strong>（C4、C5、C2），创建一个新的快照和提交 C6 作为最新版本，并且 C6 会有两个父提交 C4 和 C5。</p><figure><img src="/img/basic-merging-2.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>如果在三方合并的过程中，遇到合并冲突，即不同分支同时修改了同一块数据，那么 Git 会将冲突的内容用下面的格式展示在文件中，然后暂停下来，由用户自己处理完冲突后手动暂存和提交。</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD:index.html								</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&lt;!-- HEAD 指示版本 --&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">							</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">div</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;footer&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	contact : email.support@github.com</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">div</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;												</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&lt;!-- 当前分支所在的版本在上面 --&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=======																	</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">div</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;footer&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	please contact us at support@github.com</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">div</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&gt;&gt;&gt;&gt;&gt;&gt; iss53:index.html							</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">&lt;!-- 要合并的分支版本在下面 --&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="变基" tabindex="-1"><a class="header-anchor" href="#变基"><span>变基</span></a></h3><p>不同于 merge 的三方合并或快进，rebase 变基操作可以将修改的补丁（C4）迁移到另一个分支（master）上。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将某个分支变基到 master上，默认是当前分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rebase</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> master</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">branc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">h&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 选中在 client 分支但不在 server 分支的修改。变基到 master 上</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rebase</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --onto</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> master</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> client</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>假设我们有如下的分支结构，当前在 experiment 分支上，想要变基到 master 上，整个流程是这样的：</p><ol><li>Git 首先会找到两个分支的共同祖先 C2</li><li>然后对比当前分支（experiment）相对于该祖先的历次提交，提取相应的修改暂存</li><li>接着将当前分支指向目标（master）基底 C3，依次应用暂存的修改 C4&#39;</li><li>最后 experiment 会指向最后一次修改的补丁 C4&#39;</li></ol><p>至此变基完成，然后手动检出到 master 执行快进合并即可。</p><figure><img src="/img/basic-rebase-3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>变基与合并的结果没有任何区别，但变基使得提交历史更加整洁，原本并行的开发过程就像是串行的一样。但是变基存在一定风险，切记不要对已推送至别处的提交执行变基操作。</p><p>从合作的开发者的角度看，提交记录就是开发的历史，理论上不应该&quot;篡改&quot;，而从读者或者是新加入的开发者角度看可能只需要关注最终的结果，过程方便易读最好，所以变基与合并各有不同。</p><h3 id="远程分支" tabindex="-1"><a class="header-anchor" href="#远程分支"><span>远程分支</span></a></h3><p>远程引用是对远程仓库的引用（指针），包括分支、标签等以 <code>&lt;remote&gt;/&lt;branch/tag&gt;</code> 的形式命名，origin 是默认的远程仓库引用。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 克隆远程仓库并指定一个引用名，默认是 origin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> booyah</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ur</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">l&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 展示远程引用的完整列表</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ls-remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 缓存单个/所有远程仓库的最新数据到本地，但并不修改本地工作目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fetch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">remot</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fetch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --all</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 拉取并尝试合并远程分支 = fetch + merge</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pull</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 添加新的远程引用</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remote</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">shortnam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt; &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ur</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">l&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将本地的 serverfix 分支推送到 origin 远程仓库</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 实际上 serverfix 是 refs/heads/serverfix:refs/heads/serverfix 的简化</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> serverfix</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将本地的 serverfix 分支推送到 origin 远程仓库的 awesome 分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> serverfix:awesome</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除远程分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --delete</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> serverfix</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/img/remote-branches-5.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>从一个远程跟踪分支检出一个本地分支会自动创建<strong>跟踪分支</strong>，跟踪的远程分支叫做<strong>上游分支</strong>。也就是说本地的某个分支关联到远程仓库的某个分支，在拉取和推送时能自动关联到对应的上游分支。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 检出远程 origin 仓库的 serverfix 分支，命名为 local_branch，并自动跟踪</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> checkout</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> local_branch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin/serverfix</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 简化版，本地分支默认同名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> checkout</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --track</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin/serverfix</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> checkout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> serverfix</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 修改正在跟踪的上游分支</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin/awesome</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --set-upstream-to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin/awesome</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="高级工具" tabindex="-1"><a class="header-anchor" href="#高级工具"><span>高级工具</span></a></h2><p>众所周知，高级工具，就是很麻烦，通常也用不太到的奇技淫巧...</p><h3 id="提交引用" tabindex="-1"><a class="header-anchor" href="#提交引用"><span>提交引用</span></a></h3><h4 id="单提交" tabindex="-1"><a class="header-anchor" href="#单提交"><span>单提交</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 通过 SHA-1 引用，支持简写（只要没有冲突）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1c002dd4b536e7479fe34593e72e6c6c1819e53b</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1c002dd4b536e7479f</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1c002d</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看分支指向的特定提交</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rev-parse</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> topic1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看引用日志，记录本地仓库最近几个月 HEAD/分支 引用变更的历史</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reflog</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># HEAD 五次提交前的记录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD@{</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># HEAD 两个月前的提交记录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD@{2.months.ago}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># HEAD 上一次提交</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD^</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># HEAD 上一次提交的第二个父提交（三方合并时所在分支为第一父提交，另一个分支为第二父提交）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD^2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># HEAD 父提交的父提交</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD~2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD~~</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="多提交" tabindex="-1"><a class="header-anchor" href="#多提交"><span>多提交</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 双点区间，输出在 refA 中但不在 refB 中的提交</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> refA..refB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin/master..HEAD</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在 refA，不在 refB 和 refC 中的提交</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> refA</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ^refB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> refC</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 三点区间，输出被 refA 和 refB 其中一个包含，但不同时包含的提交，并显示处于哪一侧</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --left-right</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> refA...refB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="贮藏清理" tabindex="-1"><a class="header-anchor" href="#贮藏清理"><span>贮藏清理</span></a></h3><p><strong>stash</strong> 还是一个很有用，也很常用的功能，可以跟踪文件的修改与暂存的改动，将未完成的修改保存到一个<strong>栈</strong>上，留待以后重新应用这些改动。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 贮藏当前的修改，-u/--include-untracked 包括未跟踪的</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stash</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -u</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;stash info&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 展示贮藏列表</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> list</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 应用栈顶贮藏</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apply</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 指定应用某个贮藏记录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apply</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stash@{</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 应用贮藏并抛弃</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pop</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建新分支并应用栈顶贮藏</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> new_branch</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 抛弃某个贮藏</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> drop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stash@{</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -----------------------------------------------------------</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 清理工作目录，移除未被跟踪文件。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -f 强制</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -d 删除空的子目录</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -n 展示将执行的具体操作</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -i 进入交互模式</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clean</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -n</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="重写历史" tabindex="-1"><a class="header-anchor" href="#重写历史"><span>重写历史</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将当前分支指针移动到三个提交之前的父提交，开始变基</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 可以保留、修改、抛弃、压缩提交</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rebase</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD~3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 通过脚本一次性改写大量提交</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filter-branch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --tree-filter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;rm -f passwords.txt&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 移动 HEAD 和当前分支到指定提交，根据参数修改空间内的文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reset</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --soft</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">commi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reset</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --mixed</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">commi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reset</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --hard</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">commi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 撤销某个提交，但并不改变提交历史，而是创建一个新的提交记录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> revert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">commi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> revert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">start_commi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">...</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">end_commi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下面谈谈 <strong>reset</strong> 和 <strong>checkout</strong> 两个命令的原理。首先要知道 Git 管理了三颗不同的树：</p><ol><li><strong>HEAD</strong> 上一次提交的快照，下一次提交的父结点。也就是当前分支引用的指针，总是指向该分支上的最后一次提交。</li><li><strong>Index</strong> 预期的下一次提交的快照。，理解成暂存区。</li><li><strong>Working Directory</strong> 沙盒，也就是当前的工作目录。</li></ol><p>假设我们当前仓库里有一个文件的v1版本，状态如下： <img src="/img/reset-ex3.png" alt="" loading="lazy"></p><p>当我们修改了文件为 v2 版本后，状态如下： <img src="/img/reset-ex4.png" alt="" loading="lazy"></p><p>当执行完 <code>git add</code> 命令后： <img src="/img/reset-ex5.png" alt="" loading="lazy"></p><p>当执行完 <code>git commit</code> 命令后： <img src="/img/reset-ex6.png" alt="" loading="lazy"></p><p>现在如果执行 git status 将没有输出，因此三棵树是完全一样的。这时候如果我们执行 <code>git reset --soft HEAD~</code>来回到上一个提交，实际上是移动了当前分支（是一个指针）已到了上一次提交，HEAD 也跟着移动过去了，reset 执行就到此为止了，没有修改暂存区/工作区数据。</p><figure><img src="/img/reset-soft.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>而如果执行的是<code>git reset --mixed HEAD~</code>，那么会进一步的，用 HEAD 指向的快照来更新暂存区内的数据，这也是 reset 无参的缺省行为。</p><figure><img src="/img/reset-mixed.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>而如果执行的是<code>git reset --hard HEAD~</code>，那么会再进一步的，用 HEAD 指向的快照来更新暂存区，以及工作区内的数据，并且是强制的没有任何提示的，所以是一个危险的操作！</p><figure><img src="/img/reset-hard.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>最后如果执行的是<code>git reset file.txt</code>带有文件路径的形式，那么本质上只是将某个文件从快照中复制到暂存区。</p><figure><img src="/img/reset-checkout.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>搞懂了 reset 之后，再看 checkout 就容易多了，checkout 实际上只是移动了 HEAD 指针指向另一个分支指向的提交，并没有改变任何分支的指针。</p><h3 id="hooks" tabindex="-1"><a class="header-anchor" href="#hooks"><span>Hooks</span></a></h3><p>Git 支持在特定的重要动作发生时触发自定义脚本，即钩子，存放在<code>.git/hooks</code>目录下。分类如下：</p><ul><li>客户端钩子：clone 时不随同复制 <ul><li>提交工作流： <ul><li><code>pre-commit</code>键入提交信息前运行，如果以非0值退出将放弃提交。用于检查即将提交的快照</li><li><code>prepare-commit-msg</code>启动提交信息编辑器之前，默认信息被创建之后运行。可以编辑默认的提交信息</li><li><code>commit-msg</code>提交信息编辑后运行，非0值退出将放弃提交。可以校验项目状态和提交信息</li><li><code>post-commit</code>整个提交过程完成后运行，可用于通知事件</li></ul></li><li>电子邮件：由<code>git am</code>命令调用 <ul><li><code>applypatch-msg</code>、<code>pre-applypatch</code>、<code>post-applypatch</code></li></ul></li><li>其它： <ul><li><code>pre-rebase</code>运行于变基之前，非0值退出将中止变基</li><li><code>post-rewrite</code>被那些会替换提交记录的命令调用，如 <code>git rebase</code></li><li><code>post-checkout</code> checkout 执行成功后运行，可以调整工作目录</li><li><code>post-merge</code> merge 执行成功后运行，可以恢复 Git 无法跟踪的工作区数据</li><li><code>pre-push</code>在<code>git push</code>运行期间， 更新了远程引用但尚未传送对象时被调用</li><li><code>pre-auto-gc</code>垃圾回收开始之前被调用</li></ul></li></ul></li><li>服务端钩子： <ul><li><code>pre-receive</code>处理来自客户端的推送操作时运行，非0值退出将拒绝推送更新</li><li><code>update</code>也是处理客户端推送，但会为每个分支各执行一次，哪个运行结果非0就拒绝更新哪个分支</li><li><code>post-receive</code>整个过程完结以后运行，可以用来更新其他系统服务或者通知用户</li></ul></li></ul><h3 id="数据恢复" tabindex="-1"><a class="header-anchor" href="#数据恢复"><span>数据恢复</span></a></h3><p>如果因为意外丢失了一些有用的提交，Git 有一些方式可以恢复丢失的提交数据：</p><ul><li>Reflog 日志：提交或改变分支时，Git 会在该日志中记录 HEAD 修改的值</li><li>fsck：该工具可以检查数据库的完整性，显示出所有悬空的对象（没有被其它对象指向）</li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看 HEAD 引用的变更记录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reflog</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -g</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 找到需要的提交记录，创建一个新分支指向它</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> branch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> recover_branch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 118cccf</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 切换到所需的提交即可</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> checkout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> recover_branch</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 校验数据库完整性，找出所需的提交</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fsck</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="其它" tabindex="-1"><a class="header-anchor" href="#其它"><span>其它</span></a></h3><ol><li><strong>Rerere</strong> = <strong>Reuse Recorded Resolution</strong>，可以实现重用冲突解决的方案，通过<code>git config rerere.enabled true</code>开启这个功能后，会自动记录合并冲突的解决方案，后续遇到相同的冲突（很罕见的场景吧...）会自动应用解决方案。</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 重用记录状态</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rerere</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 显式解决方案的当前状态</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rerere</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> diff</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 应用解决方案</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rerere</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>Git 提供了一些辅助调试的命令：</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 显式文件的 70-80 行，每行最后一次修改对应的提交记录; -C 自动追踪复制源</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blame</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -L</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 70,80</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file.txt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在提交之间以二分的方式检出，标记 good/bad 从而快速找出出问题的首次提交</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bisect</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bisect</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> run</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test-error.sh</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bisect</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> good/bad</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bisect</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reset</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>Git 支持子模块功能，允许将一个 Git 仓库作为另一个仓库的子目录，同时保持提交的独立。</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> submodule</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">usernam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">rep</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">o&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> submodule</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> init</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> submodule</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> update</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> submodule</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sync</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --recursive</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> submodule</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> foreach</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;git stash&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>Bundle 打包功能可以将更新打包成一个二进制文件，用于传输。</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建一个 repo.bundle 包含所有用于重建 master 分支所需的数据</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bundle</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> repo.bundle</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> master</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 指定打包区间</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bundle</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> commits.bundle</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> master</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ^9a466c5</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 验证打包</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bundle</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> verify</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> commits.bundle</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>Git 拥有一个凭证系统处理身份认证，有以下几种选项：</li></ol><ul><li>默认所有都不缓存。 每一次连接都会询问你的用户名和密码</li><li><strong>cache</strong> 模式会将凭证存放在内存中一段时间，例如 15 分钟后从内存中清除</li><li>**store **凭证用明文的形式存放在磁盘中，并且永不过期</li><li>Mac 的 osxkeychain 模式会将凭证存入提供的钥匙串中</li><li>Windows 下有类似的 Git Credential Manager for Windows 辅助工具</li></ul><h2 id="内部原理" tabindex="-1"><a class="header-anchor" href="#内部原理"><span>内部原理</span></a></h2><p>从根本上来讲，Git 是一个内容寻址文件系统，核心部分是一个简单的键值对数据库，在此之上提供了一个版本控制系统的用户界面。</p><h3 id="目录结构" tabindex="-1"><a class="header-anchor" href="#目录结构"><span>目录结构</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ls</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -F1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hooks/</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">				# 客户端/服务端的钩子脚本</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">info/</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">				# 全局性排除文件，放置不希望记录到 .gitignore 文件的忽略模式</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">objects/</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">			# 存储所有数据内容</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">refs/</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">				# 存储指向数据的提交对象的指针</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">config</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">				# 本仓库特定的配置文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">description</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		        # 供 GitWeb 程序使用，无需关心</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">HEAD</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">				# HEAD 指针当前的引用</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">index</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">				# 保存暂存区信息</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="git-对象" tabindex="-1"><a class="header-anchor" href="#git-对象"><span>Git 对象</span></a></h3><p>每次运行 git add 、git commit 命令时，Git 所做的实质上就是：</p><ol><li>将被改写的文件保存为<strong>数据对象 blob</strong></li><li>更新暂存区，记录<strong>树对象 tree</strong></li><li>最后创建一个指明顶层树对象和父提交的<strong>提交对象 commit</strong></li></ol><p>数据对象、树对象、提交对象 三种主要的 Git 对象均以单独文件的形式保存在<code>.git/objects</code>目录下。</p><figure><img src="/img/data-model-1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>操纵 Git 对象的命令有以下的一些底层命令，也是 Git 上层命令实际调用的方法。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 返回对象的 hash 键，-w 写入数据库</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hash-object</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -w</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xxx.txt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查阅对象</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -p 判断对象内容类型，显式大致内容</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -t 打印对象类型，如 blob/tree/commit</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># -s 查看大小</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat-file</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> d670460b4b4aece5915caf5c68d12f560a9fe3e4</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 手动加入暂存区，100644 普通文件，100755 可执行文件，120000 符号链接</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> update-index</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --cacheinfo</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100644</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 83baae618040...</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file.txt</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将暂存区内容写入一个树对象</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> write-tree</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将一个已有的树读入暂存区</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> read-tree</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --prefix=bak</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> d8329f...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建提交对象，-p 指定父提交</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> commmit-tree</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">tre</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt; </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">-p</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">paren</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="git-引用" tabindex="-1"><a class="header-anchor" href="#git-引用"><span>Git 引用</span></a></h3><p>GIt 中通过引用 refs (references) 来替代原始的 SHA-1 值，更加简便。引用都保存在<code>.git/refs</code>目录下，包括<code>heads</code>保存分支引用、<code>tags</code>标签引用、<code>refs/remotes</code>远程引用等。HEAD 文件是一个特殊的引用，通常是一个符号引用（指向其它引用），指向目前所在的分支，除非是处在<code>detached HEAD</code>分离头指针状态。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 更新某个引用，所以说分支的本质就是指向某个提交的指针</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># git branch &lt;branch&gt; 或 checkout 实际就是执行 update-ref</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> update-ref</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> refs/heads/master</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1a410efbd...</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建标签引用</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> update-ref</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> refs/tags/v1.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cac0cab</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看 HEAD 指向的引用</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> symbolic-ref</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 指定 HEAD 引用</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> symbolic-ref</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> HEAD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> refs/heads/test</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>不同于数据对象、树对象、提交对象，标签引用是一个永远指向某个提交对象的对象。而远程引用是一种只读的，只有在跟服务器通信时才会更新的对象，在执行完<code>git remote add</code>后，<code>.git/config</code>中会自动添加一个小节，指定远程版本库名称、URL，以及对应的引用规范 <code>+&lt;src&gt;:&lt;dst&gt;</code>：</p><ul><li><code>+</code>表示即使在不能快进的情况下也要强制更新引用</li><li><code>&lt;src&gt;</code>是一个代表远程版本库引用的模式，只能全部通配，不能部分通配</li><li><code>&lt;dst&gt;</code>是本地跟踪的远程引用的位置</li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># fetch 时获取远程服务器的 refs/heads 下的所有引用，写入本地的 refs/remotes/origin 中</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># push 时推送本地的 master 到远程服务器上的 qa/master 分支</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[remote </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;origin&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	url</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/schacon/simplegit-progit</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	fetch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +refs/heads/</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:refs/remotes/origin/</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> refs/heads/master:refs/heads/qa/master</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 一下三个命令等价</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin/master</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remotes/origin/master</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> refs/remotes/origin/master</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 本地的 空 推送到远程的 topic，可以实现删除远程服务器上的 topic 引用</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> :topic</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> push</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> origin</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --delete</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> topic</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><div id="comment" class="giscus-wrapper input-top vp-comment" vp-comment style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">Powered by <a href="https://theme-hope.vuejs.press/zh/">VuePress Theme Hope</a></div><div class="vp-copyright">独立思考，明辨是非，尊重他人命运</div></footer></div><!--]--><!--]--><!--[--><!----><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CHBNztBQ.js" defer></script>
  </body>
</html>
